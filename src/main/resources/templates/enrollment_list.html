<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Enrollments</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

	<!--  Bootstrap Bundle includes Popper.js for modal -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</head>
<body>
<div class="container mt-5">
    <h2 class="mb-4">All Enrollments</h2>
    <table class="table table-bordered">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Student ID</th>
                <th>Student Name</th>
                <th>Phone</th>
                <th>Course ID</th>
                <th>Employee ID</th>
                <th>Date</th>
                <th>Status</th>
                <th>Grade</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
			<tr th:each="enroll : ${enrollments}">
			    <td th:text="${enroll.id}">ID</td>
			    <td th:text="${enroll.student?.id}">Student ID</td>
				<td th:text="${enroll.student?.name}">Name</td>
				<td th:text="${enroll.student?.phone}">Phone</td>

			    <td th:text="${enroll.course?.id}">Course ID</td>
			    <td th:text="${enroll.employeeId}">Employee ID</td>
			    <td th:text="${enroll.enrollmentDate}">Date</td>
			    <td th:text="${enroll.status}">-</td>
			    <td th:text="${enroll.grade}">-</td>
			    <td>
			        <a th:href="@{'/enrollments/edit/' + ${enroll.id}}" class="btn btn-sm btn-warning">Edit</a>
			        <form th:action="@{'/enrollments/delete/' + ${enroll.id}}" method="post" style="display:inline;">
			            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
			        </form>
			        <button type="button" class="btn btn-sm btn-info" th:attr="data-id=${enroll.id}" onclick="viewDetails(this)">View</button>
			    </td>
			</tr>

        </tbody>
    </table>

	<div class="modal" tabindex="-1" id="detailsModal" role="dialog">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title">Modal title</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
			<div class="modal-body">
			                    <p><strong>Student Name:</strong> <span id="modal-student-name"></span></p>
			                    <p><strong>Phone:</strong> <span id="modal-student-phone"></span></p>
			                    <p><strong>Course Name:</strong> <span id="modal-course-name"></span></p>
			                    <p><strong>Course Fee:</strong> <span id="modal-course-fee"></span></p>
			                    <p><strong>Status:</strong> <span id="modal-status"></span></p>
			                    <p><strong>Grade:</strong> <span id="modal-grade"></span></p>
			                </div>
	     
	      <div class="modal-footer">
	        <button type="button" class="btn btn-primary">Save changes</button>
	        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
	      </div>
	    </div>
	  </div>
	</div>

               <!-- <div class="modal-body">
                    <p><strong>Student Name:</strong> <span id="modal-student-name"></span></p>
                    <p><strong>Phone:</strong> <span id="modal-student-phone"></span></p>
                    <p><strong>Course Name:</strong> <span id="modal-course-name"></span></p>
                    <p><strong>Course Fee:</strong> <span id="modal-course-fee"></span></p>
                    <p><strong>Status:</strong> <span id="modal-status"></span></p>
                    <p><strong>Grade:</strong> <span id="modal-grade"></span></p>
                </div>
				-->
           

<!-- Script for modal -->
<script>
function viewDetails(btn) {
	
    const id = btn.getAttribute('data-id');
    fetch('/details/${id}')
        .then(res => res.json())
        .then(data => {
            document.getElementById('modal-student-name').textContent = data.student.name;
            document.getElementById('modal-student-phone').textContent = data.student.phone;
            document.getElementById('modal-course-name').textContent = data.course.courseName;
            document.getElementById('modal-course-fee').textContent = data.course.courseFee;
            document.getElementById('modal-status').textContent = data.status;
            document.getElementById('modal-grade').textContent = data.grade;
            new bootstrap.Modal(document.getElementById('detailsModal')).show();
        });
		
}
</script>

</body>
</html>
