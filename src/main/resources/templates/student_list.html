<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Registered Students</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('#searchInput').on('keyup', function () {
            let name = $(this).val();

            $.ajax({
                url: '/students/search',
                type: 'GET',
                data: { name: name },
                success: function (students) {
                    let html = '';
                    students.forEach(student => {
						html += `
						    <tr>
						        <td>${student.id}</td>
						        <td>${student.name}</td>
						        <td>${student.phone}</td>
						        <td>${student.address}</td>
						        <td>${student.gender}</td>
						        <td>${student.email}</td>
						        <td>
						            <a href="/students/edit/${student.id}" class="btn btn-warning btn-sm">Edit</a>
						            <form action="/students/delete/${student.id}" method="post"
						                  style="display:inline-block"
						                  onsubmit="return confirm('Delete this student?');">
						                <button type="submit" class="btn btn-danger btn-sm ms-1">Delete</button>
						            </form>
						        </td>
						    </tr>`;

                    });
                    $('#studentTableBody').html(html);
                }
            });
        });
    });
</script>

<body>
<div class="container mt-5">
    <h2 class="text-center mb-4">Registered Students</h2>
    <div class="text-center mb-3">
        <a href="/register" class="btn btn-success">Add New Student</a>
		<div style="text-align: center;">
			<br><br>
		  <input type="text" id="searchInput" class="form-control" placeholder="Enter student name" style="width: 450px; display: inline-block;">
		  <br><br>

	  </div>

    </div>
	
    <table class="table table-bordered table-striped shadow">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Address</th>
                <th>Gender</th>
                <th style="width: 180px;">Action</th>
            </tr>
        </thead>
        <tbody id="studentTableBody">
            <tr th:each="student : ${students}">
                <td th:text="${student.id}"></td>
                <td th:text="${student.name}"></td>
                <td th:text="${student.email}"></td>
                <td th:text="${student.phone}"></td>
                <td th:text="${student.address}"></td>
                <td th:text="${student.gender}"></td>
                <td>
                    <a th:href="@{'/students/edit/' + ${student.id}}" class="btn btn-warning btn-sm">Edit</a>
                    <form th:action="@{'/students/delete/' + ${student.id}}" method="post"
                          style="display:inline-block"
                          onsubmit="return confirm('Delete this student?');">
                        <button type="submit" class="btn btn-danger btn-sm ms-1">Delete</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</body>
</html>
